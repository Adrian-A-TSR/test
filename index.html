<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<title>InterviewAI â€” Clipboard Health</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,400&family=Syne:wght@700;800&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#07080d;
  --s1:#0c0d15;
  --s2:#11131d;
  --s3:#161824;
  --border:#1c1f2e;
  --border2:#252838;
  --teal:#00dda8;
  --teal-glow:rgba(0,221,168,0.15);
  --teal-dim:rgba(0,221,168,0.08);
  --amber:#ffc147;
  --amber-dim:rgba(255,193,71,0.10);
  --red:#ff4f6a;
  --red-dim:rgba(255,79,106,0.10);
  --blue:#6ba3ff;
  --blue-dim:rgba(107,163,255,0.10);
  --text:#dde0ef;
  --text2:#9298b5;
  --muted:#484d6a;
  --mono:'DM Mono',monospace;
  --display:'Syne',sans-serif;
  --sans:'DM Sans',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:var(--mono);overflow:hidden;-webkit-font-smoothing:antialiased}

/* â•â•â• SETUP â•â•â• */
#setup{
  position:fixed;inset:0;background:var(--bg);
  display:flex;flex-direction:column;align-items:center;
  padding:36px 20px 28px;z-index:200;overflow-y:auto;
}
.setup-mark{
  width:56px;height:56px;border-radius:16px;
  background:linear-gradient(135deg,var(--teal),#00aaff);
  display:flex;align-items:center;justify-content:center;
  font-size:26px;margin-bottom:18px;
  box-shadow:0 0 40px rgba(0,221,168,0.25),0 0 80px rgba(0,221,168,0.1);
}
.setup-title{
  font-family:var(--display);font-size:28px;font-weight:800;letter-spacing:-0.5px;margin-bottom:4px;
}
.setup-title span{color:var(--teal);}
.setup-sub{font-size:10px;color:var(--text2);letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;}
.cbh-pill{
  display:inline-flex;align-items:center;gap:6px;
  background:var(--teal-dim);border:1px solid rgba(0,221,168,0.18);
  border-radius:20px;padding:5px 14px;font-size:9.5px;
  color:var(--teal);letter-spacing:.5px;margin-bottom:28px;
}
.pulse-dot{width:5px;height:5px;border-radius:50%;background:var(--teal);animation:pdot 2s infinite;}
@keyframes pdot{0%,100%{opacity:1}50%{opacity:.2}}

.setup-card{
  width:100%;max-width:400px;
  background:var(--s1);border:1px solid var(--border);border-radius:18px;overflow:hidden;
}
.s-sec{padding:20px;border-bottom:1px solid var(--border);}
.s-sec:last-child{border-bottom:none;}
.s-lbl{font-size:9px;font-weight:500;color:var(--teal);letter-spacing:2px;text-transform:uppercase;margin-bottom:8px;}
.s-inp{
  width:100%;background:var(--bg);border:1px solid var(--border2);
  border-radius:10px;padding:11px 14px;color:var(--text);
  font-family:var(--mono);font-size:13px;outline:none;transition:border-color .2s;
}
.s-inp:focus{border-color:var(--teal);}
.s-hint{font-size:9.5px;color:var(--muted);margin-top:6px;line-height:1.55;}
.s-hint a{color:var(--teal);text-decoration:none;}

.info-box{
  display:flex;gap:9px;background:var(--amber-dim);
  border:1px solid rgba(255,193,71,0.15);border-radius:10px;padding:12px;
}
.info-box+.info-box{margin-top:8px;}
.info-icon{font-size:15px;flex-shrink:0;margin-top:1px;}
.info-copy{font-size:10px;color:var(--amber);line-height:1.6;}
.info-copy strong{display:block;font-size:11px;margin-bottom:2px;color:var(--amber);}

.btn-go{
  width:100%;padding:16px;border:none;border-radius:13px;cursor:pointer;
  background:linear-gradient(135deg,var(--teal) 0%,#00b8f0 100%);
  color:#07080d;font-family:var(--display);font-size:19px;font-weight:700;
  letter-spacing:.5px;transition:all .2s;margin-top:16px;
  box-shadow:0 8px 24px rgba(0,221,168,0.2);
}
.btn-go:active{transform:scale(.98);opacity:.9;}

/* â•â•â• MAIN APP â•â•â• */
#app{display:none;flex-direction:column;height:100vh;overflow:hidden;}

/* Topbar */
.topbar{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 14px 8px;background:var(--s1);
  border-bottom:1px solid var(--border);flex-shrink:0;
}
.t-left{display:flex;align-items:center;gap:10px;}
.ring-wrap{position:relative;width:36px;height:36px;flex-shrink:0;}
.ring-wrap svg{position:absolute;inset:0;width:36px;height:36px;}
.ring-center{
  position:absolute;inset:0;display:flex;
  align-items:center;justify-content:center;font-size:14px;
}
.rt{fill:none;stroke:var(--border2);stroke-width:2.5;}
.rf{
  fill:none;stroke:var(--teal);stroke-width:2.5;stroke-linecap:round;
  stroke-dasharray:92;stroke-dashoffset:92;
  transform:rotate(-90deg);transform-origin:18px 18px;
  transition:stroke-dashoffset .4s,stroke .3s;
}
.rf.listen{stroke-dashoffset:0;animation:rpulse 2.2s ease-in-out infinite;}
.rf.think{stroke:var(--amber);stroke-dashoffset:22;animation:rspin 1.1s linear infinite;}
.rf.err{stroke:var(--red);stroke-dashoffset:0;}
@keyframes rpulse{0%,100%{opacity:1}50%{opacity:.4}}
@keyframes rspin{from{stroke-dashoffset:92}to{stroke-dashoffset:0}}

.t-info{}
.t-name{font-family:var(--display);font-size:16px;font-weight:700;letter-spacing:.2px;}
.t-name em{color:var(--teal);font-style:normal;}
.t-status{font-size:9px;color:var(--muted);letter-spacing:.5px;margin-top:1px;transition:color .3s;}
.t-status.live{color:var(--teal);}
.t-status.think{color:var(--amber);}
.t-status.err{color:var(--red);}

.t-right{display:flex;gap:6px;}
.ib{
  width:34px;height:34px;border-radius:9px;border:1px solid var(--border2);
  background:transparent;color:var(--muted);cursor:pointer;
  display:flex;align-items:center;justify-content:center;font-size:15px;
  transition:all .15s;
}
.ib:active{background:var(--s3);color:var(--text);}

/* Mode tabs */
.modes{
  display:flex;background:var(--s2);border-bottom:1px solid var(--border);
  flex-shrink:0;overflow-x:auto;scrollbar-width:none;
}
.modes::-webkit-scrollbar{display:none;}
.mtab{
  flex:1;min-width:0;padding:9px 3px 7px;border:none;
  background:transparent;color:var(--muted);
  font-family:var(--mono);font-size:8.5px;font-weight:500;
  letter-spacing:.8px;text-transform:uppercase;cursor:pointer;
  border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap;
}
.mtab.on{color:var(--teal);border-bottom-color:var(--teal);}

/* Quick chips */
.qqs{
  display:flex;gap:6px;padding:7px 11px;
  background:var(--s1);border-bottom:1px solid var(--border);
  flex-shrink:0;overflow-x:auto;scrollbar-width:none;
}
.qqs::-webkit-scrollbar{display:none;}
.qchip{
  flex:0 0 auto;padding:5px 12px;border-radius:20px;
  border:1px solid var(--border2);background:transparent;
  color:var(--text2);font-family:var(--mono);font-size:9.5px;
  cursor:pointer;white-space:nowrap;transition:all .18s;
}
.qchip:active,.qchip.hi{background:var(--teal-dim);border-color:var(--teal);color:var(--teal);}

/* Feed */
.feed{
  flex:1;overflow-y:auto;padding:11px 11px 6px;
  display:flex;flex-direction:column;gap:10px;scroll-behavior:smooth;
}
.feed::-webkit-scrollbar{width:2px;}
.feed::-webkit-scrollbar-thumb{background:var(--border2);border-radius:1px;}

/* Empty */
.empty{
  flex:1;display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  text-align:center;padding:24px 20px;gap:10px;
}
.empty-ring{
  width:60px;height:60px;border-radius:50%;
  border:2px dashed var(--border2);
  display:flex;align-items:center;justify-content:center;
  font-size:24px;opacity:.45;
}
.empty-h{font-family:var(--display);font-size:18px;color:var(--muted);letter-spacing:.3px;}
.empty-d{font-size:11px;color:var(--muted);line-height:1.65;max-width:230px;}
.ev-chips{display:flex;gap:5px;flex-wrap:wrap;justify-content:center;margin-top:4px;}
.ev{
  background:var(--teal-dim);border:1px solid rgba(0,221,168,0.14);
  border-radius:20px;padding:3px 10px;font-size:8.5px;color:var(--teal);
}

/* Heard */
.heard{
  background:var(--s2);border:1px solid var(--border2);
  border-radius:12px;padding:11px 13px;
}
.heard-lbl{font-size:8.5px;color:var(--muted);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:5px;}
.heard-txt{font-size:13px;color:var(--text);line-height:1.55;min-height:18px;}
.heard-txt.interim{color:var(--text2);font-style:italic;}

/* Thinking */
.think-card{
  background:var(--s2);border:1px solid var(--border2);
  border-radius:12px;padding:14px 16px;
  display:flex;align-items:center;gap:12px;
  animation:slup .3s ease;
}
.tdots{display:flex;gap:4px;}
.tdots span{
  width:5px;height:5px;border-radius:50%;background:var(--amber);
  animation:db .85s ease-in-out infinite;
}
.tdots span:nth-child(2){animation-delay:.15s;}
.tdots span:nth-child(3){animation-delay:.30s;}
@keyframes db{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
.think-txt{font-size:11px;color:var(--text2);}

/* Answer card */
.acard{
  border-radius:14px;overflow:hidden;
  border:1px solid rgba(0,221,168,0.18);
  animation:slup .4s cubic-bezier(.16,1,.3,1);
}
@keyframes slup{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}

.ahead{
  background:linear-gradient(90deg,rgba(0,221,168,0.1),rgba(0,221,168,0.03));
  padding:8px 13px;display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid rgba(0,221,168,0.1);
}
.ahead-l{display:flex;align-items:center;gap:7px;}
.albl{font-size:8.5px;color:var(--teal);font-weight:500;letter-spacing:1.5px;text-transform:uppercase;}
.mbadge{
  background:var(--teal-dim);border:1px solid rgba(0,221,168,0.18);
  border-radius:4px;padding:1px 6px;font-size:8px;color:var(--teal);letter-spacing:.5px;
}
.atime{font-size:8.5px;color:var(--muted);}

/* THE KEY: big, scannable answer text */
.abody{
  background:var(--s1);padding:16px 14px;
  font-family:var(--sans);font-size:16px;line-height:1.8;color:var(--text);
}
.abody strong{color:var(--teal);font-weight:700;}
.abody em{
  color:var(--amber);font-style:normal;font-size:9px;
  letter-spacing:1.5px;text-transform:uppercase;font-family:var(--mono);
  display:block;margin:12px 0 4px;opacity:.85;
}
.abody p{margin-bottom:10px;}
.abody p:last-child{margin-bottom:0;}

.afoot{display:flex;border-top:1px solid var(--border);}
.afbtn{
  flex:1;padding:10px 6px;background:transparent;border:none;
  color:var(--muted);font-family:var(--mono);font-size:9.5px;
  cursor:pointer;transition:all .2s;border-right:1px solid var(--border);
  letter-spacing:.3px;
}
.afbtn:last-child{border-right:none;}
.afbtn:active{background:var(--s3);color:var(--text);}

/* Error card */
.ercard{
  background:#120607;border:1px solid #3a0f14;border-radius:12px;
  padding:12px 14px;font-size:11.5px;color:#ff6b6b;
}

/* Bottom bar */
.bottom{
  background:var(--s1);border-top:1px solid var(--border);
  padding:10px 12px 16px;flex-shrink:0;
}
.mrow{display:flex;gap:7px;margin-bottom:8px;}
.minp{
  flex:1;background:var(--bg);border:1px solid var(--border2);
  border-radius:10px;padding:10px 12px;color:var(--text);
  font-family:var(--mono);font-size:12.5px;outline:none;transition:border-color .2s;
}
.minp:focus{border-color:var(--teal);}
.msend{
  width:40px;height:40px;border-radius:10px;border:none;
  background:var(--teal);color:var(--bg);cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  font-size:16px;flex-shrink:0;font-weight:700;transition:opacity .2s;
}
.msend:active{opacity:.8;}

/* Big mic */
.mic-outer{position:relative;}
.mic-btn{
  width:100%;padding:15px 12px;border-radius:14px;border:2px solid var(--border2);
  background:var(--s2);cursor:pointer;
  display:flex;align-items:center;justify-content:center;gap:10px;
  transition:all .25s;position:relative;overflow:hidden;
}
.mic-btn::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,var(--teal),#00b8f0);
  opacity:0;transition:opacity .25s;
}
.mic-btn.live{border-color:var(--teal);box-shadow:0 0 30px rgba(0,221,168,0.22);}
.mic-btn.live::before{opacity:1;}
.mic-btn:active{transform:scale(.98);}

.mic-icon{font-size:20px;position:relative;z-index:1;transition:all .25s;}
.mic-lbl{
  font-family:var(--display);font-size:18px;letter-spacing:.5px;
  color:var(--text2);position:relative;z-index:1;transition:color .25s;
}
.mic-btn.live .mic-lbl{color:var(--bg);}

.wbars{display:none;align-items:center;gap:2px;position:relative;z-index:1;}
.wbars.show{display:flex;}
.wbars span{
  width:3px;background:var(--bg);border-radius:2px;
  animation:wb .9s ease-in-out infinite;
}
.wbars span:nth-child(1){height:8px;animation-delay:0s}
.wbars span:nth-child(2){height:16px;animation-delay:.1s}
.wbars span:nth-child(3){height:10px;animation-delay:.2s}
.wbars span:nth-child(4){height:18px;animation-delay:.3s}
.wbars span:nth-child(5){height:8px;animation-delay:.4s}
@keyframes wb{0%,100%{transform:scaleY(1)}50%{transform:scaleY(.3)}}

/* Silence progress bar */
.sbar{height:2px;background:var(--border2);border-radius:1px;margin-top:6px;display:none;}
.sbar.show{display:block;}
.sfill{height:100%;background:var(--teal);border-radius:1px;width:0;transition:width linear;}

/* Pause badge */
.pause-badge{
  display:none;position:fixed;bottom:120px;left:50%;transform:translateX(-50%);
  background:rgba(107,163,255,0.12);border:1px solid rgba(107,163,255,0.22);
  border-radius:20px;padding:6px 16px;font-size:10px;color:var(--blue);
  z-index:50;align-items:center;gap:6px;white-space:nowrap;
  animation:slup .3s ease;
}
.pause-badge.show{display:flex;}

/* Toast */
.toast{
  position:fixed;bottom:130px;left:50%;transform:translateX(-50%);
  background:var(--s3);border:1px solid var(--border2);
  border-radius:10px;padding:9px 16px;font-size:11px;color:var(--text);
  z-index:300;opacity:0;transition:opacity .25s;white-space:nowrap;pointer-events:none;
}
.toast.show{opacity:1;}

/* Settings */
#settings{
  position:fixed;inset:0;background:var(--bg);z-index:150;
  display:none;flex-direction:column;overflow-y:auto;padding:20px;
}
#settings.open{display:flex;}
.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:22px;}
.stitle{font-family:var(--display);font-size:22px;font-weight:700;}
.scls{
  width:36px;height:36px;border-radius:9px;border:1px solid var(--border2);
  background:transparent;color:var(--muted);cursor:pointer;font-size:18px;
  display:flex;align-items:center;justify-content:center;
}
.sblk{margin-bottom:18px;}
.ssec{font-size:9px;color:var(--teal);letter-spacing:2px;text-transform:uppercase;margin-bottom:10px;}
.scard{background:var(--s1);border:1px solid var(--border);border-radius:12px;overflow:hidden;}
.srow{padding:12px 14px;border-bottom:1px solid var(--border);}
.srow:last-child{border-bottom:none;}
.srow label{display:block;font-size:9px;color:var(--teal);font-weight:500;letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;}
.srow input,.srow textarea,.srow select{
  width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:8px;
  padding:9px 11px;color:var(--text);font-family:var(--mono);font-size:11.5px;outline:none;
}
.srow textarea{resize:vertical;min-height:90px;line-height:1.5;}
.srow select{cursor:pointer;}
.sbtn{
  width:100%;padding:14px;border-radius:12px;border:none;cursor:pointer;
  background:linear-gradient(135deg,var(--teal),#00b8f0);
  color:var(--bg);font-family:var(--display);font-size:17px;font-weight:700;
  letter-spacing:.3px;margin-top:4px;
}

/* â•â•â• FLASH CARD OVERLAY â•â•â• */
#flash-overlay{
  position:fixed;top:0;left:0;right:0;z-index:100;
  display:none;flex-direction:column;
  background:linear-gradient(180deg,#07080d 90%,transparent 100%);
  padding:10px 12px 18px;
  animation:flashIn .35s cubic-bezier(.16,1,.3,1);
}
#flash-overlay.show{display:flex;}
@keyframes flashIn{from{opacity:0;transform:translateY(-16px)}to{opacity:1;transform:translateY(0)}}

.flash-tag{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:6px;
}
.flash-tag-left{display:flex;align-items:center;gap:7px;}
.flash-badge{
  background:rgba(255,193,71,0.15);border:1px solid rgba(255,193,71,0.3);
  border-radius:5px;padding:2px 8px;font-size:8px;color:var(--amber);
  letter-spacing:1.5px;font-weight:600;text-transform:uppercase;
}
.flash-match{font-size:8.5px;color:var(--muted);}
.flash-timer-ring{position:relative;width:22px;height:22px;flex-shrink:0;}
.flash-timer-ring svg{width:22px;height:22px;}
.ftr{fill:none;stroke:var(--border2);stroke-width:2.5;}
.ftf{
  fill:none;stroke:var(--amber);stroke-width:2.5;stroke-linecap:round;
  stroke-dasharray:57;stroke-dashoffset:0;
  transform:rotate(-90deg);transform-origin:11px 11px;
}

.flash-card{
  background:var(--s2);border:1px solid rgba(255,193,71,0.25);
  border-radius:14px;overflow:hidden;
  box-shadow:0 8px 32px rgba(0,0,0,0.4),0 0 0 1px rgba(255,193,71,0.08);
}
.flash-head{
  background:linear-gradient(90deg,rgba(255,193,71,0.12),rgba(255,193,71,0.04));
  padding:9px 14px;border-bottom:1px solid rgba(255,193,71,0.12);
  display:flex;align-items:center;gap:7px;
}
.flash-head-icon{font-size:13px;}
.flash-head-label{font-size:8.5px;color:var(--amber);letter-spacing:1.5px;font-weight:600;text-transform:uppercase;}
.flash-q{
  padding:10px 14px 6px;font-size:11px;color:var(--text2);
  font-family:var(--mono);line-height:1.4;
  border-bottom:1px dashed var(--border2);
}
.flash-body{
  padding:14px;max-height:42vh;overflow-y:auto;
  font-family:var(--sans);font-size:15.5px;line-height:1.78;color:var(--text);
  scroll-behavior:smooth;
}
.flash-body::-webkit-scrollbar{width:2px;}
.flash-body::-webkit-scrollbar-thumb{background:rgba(255,193,71,0.3);border-radius:1px;}
.flash-body strong{color:var(--amber);font-weight:700;}
.flash-body em{
  color:var(--teal);font-style:normal;font-size:9px;
  letter-spacing:1.5px;text-transform:uppercase;font-family:var(--mono);
  display:block;margin:10px 0 3px;
}
.flash-body p{margin-bottom:10px;}
.flash-body p:last-child{margin-bottom:0;}
.flash-foot{
  display:flex;border-top:1px solid var(--border);
}
.flash-foot-btn{
  flex:1;padding:10px 8px;background:transparent;border:none;
  color:var(--muted);font-family:var(--mono);font-size:9.5px;
  cursor:pointer;transition:all .2s;border-right:1px solid var(--border);
  letter-spacing:.3px;
}
.flash-foot-btn:last-child{border-right:none;}
.flash-foot-btn:active,.flash-foot-btn:hover{background:var(--s3);color:var(--text);}
.flash-foot-btn.primary{color:var(--amber);}
</style>
</head>
<body>

<!-- â•â•â•â• SETUP â•â•â•â• -->
<div id="setup">
  <div class="setup-mark">ğŸ¯</div>
  <div class="setup-title">Interview<span>AI</span></div>
  <div class="setup-sub">Powered by Gemini Â· Built for Adrian</div>
  <div class="cbh-pill">
    <span class="pulse-dot"></span>
    Clipboard Health Â· CX Specialist
  </div>

  <div class="setup-card">
    <div class="s-sec">
      <div class="s-lbl">Gemini API Key</div>
      <input class="s-inp" type="password" id="api-key-input" placeholder="AIzaSyâ€¦" autocomplete="off" spellcheck="false"/>
      <div class="s-hint">Get your free key at <a href="https://aistudio.google.com" target="_blank">aistudio.google.com</a> â†’ Get API Key. No credit card. Stored only on this device.</div>
    </div>

    <div class="s-sec">
      <div class="info-box">
        <div class="info-icon">ğŸ™</div>
        <div class="info-copy">
          <strong>Always-On Mic</strong>
          Tap START once. Mic stays open the whole interview. Your answer auto-appears 2.5 seconds after the recruiter stops talking. You never tap again.
        </div>
      </div>
      <div class="info-box">
        <div class="info-icon">ğŸ§ </div>
        <div class="info-copy">
          <strong>Smart Question Detection</strong>
          If the mic picks up YOU asking a question to the recruiter, it silently skips â€” no answer generated. Pre-loaded with your resume &amp; all Clipboard Health context.
        </div>
      </div>
    </div>

    <div class="s-sec" style="border-bottom:none;">
      <button class="btn-go" onclick="startApp()">START INTERVIEW â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â• APP â•â•â•â• -->
<div id="app">

  <div class="topbar">
    <div class="t-left">
      <div class="ring-wrap">
        <svg viewBox="0 0 36 36">
          <circle class="rt" cx="18" cy="18" r="14.5"/>
          <circle class="rf" id="rf" cx="18" cy="18" r="14.5"/>
        </svg>
        <div class="ring-center" id="ring-icon">ğŸ™</div>
      </div>
      <div class="t-info">
        <div class="t-name">Interview<em>AI</em></div>
        <div class="t-status" id="t-status">Tap START to begin</div>
      </div>
    </div>
    <div class="t-right">
      <button class="ib" onclick="clearFeed()">ğŸ—‘</button>
      <button class="ib" onclick="openSettings()">âš™</button>
    </div>
  </div>

  <div class="modes">
    <button class="mtab on" id="tab-general"    onclick="setMode('general')">GENERAL</button>
    <button class="mtab"    id="tab-behavioral" onclick="setMode('behavioral')">BEHAVIORAL</button>
    <button class="mtab"    id="tab-role"       onclick="setMode('role')">ROLE</button>
    <button class="mtab"    id="tab-values"     onclick="setMode('values')">VALUES</button>
    <button class="mtab"    id="tab-closing"    onclick="setMode('closing')">CLOSING</button>
  </div>

  <div class="qqs" id="qqs"></div>

  <!-- â•â•â•â• FLASH CARD OVERLAY â•â•â•â• -->
  <div id="flash-overlay">
    <div class="flash-tag">
      <div class="flash-tag-left">
        <div class="flash-badge">âš¡ CHEAT SHEET</div>
        <div class="flash-match" id="flash-match-label"></div>
      </div>
      <div class="flash-timer-ring">
        <svg viewBox="0 0 22 22">
          <circle class="ftr" cx="11" cy="11" r="9"/>
          <circle class="ftf" id="ftf" cx="11" cy="11" r="9"/>
        </svg>
      </div>
    </div>
    <div class="flash-card">
      <div class="flash-head">
        <div class="flash-head-icon">ğŸ“‹</div>
        <div class="flash-head-label">PREPARED ANSWER</div>
      </div>
      <div class="flash-q" id="flash-q-text"></div>
      <div class="flash-body" id="flash-body"></div>
      <div class="flash-foot">
        <button class="flash-foot-btn" onclick="dismissFlash()">âœ• Dismiss</button>
        <button class="flash-foot-btn primary" onclick="keepFlash()">ğŸ“Œ Keep visible</button>
        <button class="flash-foot-btn" onclick="copyFlash()">â˜ Copy</button>
      </div>
    </div>
  </div>

  <div class="feed" id="feed">
    <div class="empty" id="empty">
      <div class="empty-ring">ğŸ™</div>
      <div class="empty-h">Ready for battle</div>
      <div class="empty-d">Tap START â€” the mic stays open. Your answer appears automatically after the recruiter finishes speaking.</div>
      <div class="ev-chips">
        <span class="ev">Unreasonably Fast</span>
        <span class="ev">Ownership</span>
        <span class="ev">High Standards</span>
      </div>
    </div>
  </div>

  <div class="pause-badge" id="pause-badge">ğŸ”‡ Your question â€” skipping</div>

  <div class="bottom">
    <div class="mrow">
      <input class="minp" id="minp" placeholder="Or type a question hereâ€¦" onkeydown="if(event.key==='Enter')sendManual()"/>
      <button class="msend" onclick="sendManual()">â†‘</button>
    </div>
    <div class="mic-outer">
      <button class="mic-btn" id="mic-btn" onclick="toggleSession()">
        <div class="wbars" id="wbars">
          <span></span><span></span><span></span><span></span><span></span>
        </div>
        <span class="mic-icon" id="mic-icon">ğŸ™</span>
        <span class="mic-lbl" id="mic-lbl">START</span>
      </button>
      <div class="sbar" id="sbar"><div class="sfill" id="sfill"></div></div>
    </div>
  </div>
</div>

<!-- â•â•â•â• SETTINGS â•â•â•â• -->
<div id="settings">
  <div class="sh">
    <div class="stitle">Settings</div>
    <button class="scls" onclick="closeSettings()">âœ•</button>
  </div>
  <div class="sblk">
    <div class="ssec">API</div>
    <div class="scard">
      <div class="srow"><label>Gemini API Key</label><input type="password" id="s-key" spellcheck="false"/></div>
    </div>
  </div>
  <div class="sblk">
    <div class="ssec">Your Context</div>
    <div class="scard">
      <div class="srow"><label>Your Name</label><input type="text" id="s-name"/></div>
      <div class="srow"><label>Resume Summary</label><textarea id="s-resume"></textarea></div>
      <div class="srow"><label>Job &amp; Company Context</label><textarea id="s-job"></textarea></div>
      <div class="srow"><label>Talking Points &amp; STAR Stories</label><textarea id="s-talking"></textarea></div>
    </div>
  </div>
  <div class="sblk">
    <div class="ssec">Answer Style</div>
    <div class="scard">
      <div class="srow">
        <label>Response Length</label>
        <select id="s-length">
          <option value="concise">Concise (2â€“3 sentences)</option>
          <option value="standard" selected>Standard (4â€“6 sentences)</option>
          <option value="detailed">Detailed (full STAR)</option>
        </select>
      </div>
    </div>
  </div>
  <button class="sbtn" onclick="saveSettings()">Save Settings</button>
</div>

<div class="toast" id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PRE-LOADED DEFAULTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEF_RESUME=`CANDIDATE: Adrian D. Alasco
TARGET: Customer Experience Specialist at Clipboard Health

EXPERIENCE (8+ years):
1. Microsoft Community & Q&A Support (05/2025â€“Present)
   - Forum expert support for Windows & Microsoft products
   - Diagnose update failures, activation, licensing, system errors
   - Probing questions to isolate root cause; prevent repeat issues
   - High-quality responses balancing speed, clarity, accuracy

2. Mac+ Support, Level 2 â€” Teleperformance (08/2022â€“03/2025)
   - Level 2 macOS support via phone, chat, email
   - Ticket triage, CRM documentation in Zendesk & Salesforce
   - Identified repeat issues; contributed to internal knowledge base
   - Guided customers through account access & device configuration

3. Mentor, Apple Technical Support â€” Majorel (09/2019â€“01/2022)
   - Onboarded and trained 100+ new advisors (30% faster ramp time)
   - Side-by-side mentoring, chat reviews, quality coaching
   - Reinforced ticketing standards, documentation, escalation workflows
   - Supported advisors with difficult cases, root cause isolation

4. Microsoft Technical Support â€” Sutherland (06/2016â€“05/2019)
   - 40+ cases/day across Windows OS, network, drivers
   - Remote desktop via Quick Assist and LogMeIn
   - Escalated with clear notes, steps to reproduce, customer impact
   - Identified repeat failure patterns; suggested process improvements

5. Supervisor â€” Kybotech LTD (02/2015â€“06/2016)
   - Oversaw daily operations; first-level escalation point

KEY METRICS:
- 95%+ CSAT ratings across voice, chat, email
- 6.5 min average handle time
- 100+ advisors trained; 30% ramp time reduction; 20% fewer escalations
- 60% resolution efficiency improvement
- Zero re-opened tickets during Microsoft update crisis

SKILLS: Zendesk, Salesforce, macros, CRM documentation, payment troubleshooting,
trend analysis, mentoring, account investigations, pattern recognition, escalation judgment`;

const DEF_JOB=`COMPANY: Clipboard Health (clipboardhealth.com)
TYPE: Two-sided marketplace connecting healthcare facilities (nursing homes, hospitals) with healthcare professionals (nurses, CNAs, etc.) for per-diem & urgent shift staffing.
SCALE: $1.3B valuation, Series C, Sequoia & IVP backed. YC top 100. 950+ team members in 60+ countries. 100% remote since day 1. 20X growth since Jan 2021.
MISSION: Lift healthcare workers up the socio-economic ladder. Give them income control, schedule flexibility, and faster pay.
PRODUCTS: Mobile app for HCPs â€” InstantPay (get paid right after shift), License Manager, Priority Access, Urgent Shifts, Digital Timesheets, Work with Friends, Maple scheduling.

JOB RESPONSIBILITIES:
1. Fast, accurate, empathetic support for healthcare professionals â€” chat, voice, email â€” resolving shift, payment, platform issues in real time
2. Navigate Zendesk and Salesforce to investigate cases, update form fields, log clear internal notes, accurate documentation
3. Sound judgment and critical thinking â€” troubleshoot, adapt workflows, escalate ONLY when necessary
4. Personalize communication with macros, address workers by name, proofread carefully, confident helpful tone
5. Monitor trends, flag recurring issues or process gaps to improve worker experience and operations
6. Support onboarding â€” guide new workers through platform workflows, help them gain confidence
7. Uphold values: UNREASONABLY FAST Â· OWNERSHIP Â· UNCOMFORTABLY HIGH STANDARDS in every interaction

ALL 13 CLIPBOARD HEALTH VALUES:
1. Noticing & Curiosity â€” ask "why" many times, find root cause, challenge assumptions, disconfirm beliefs
2. Ownership â€” full accountability, own the outcome, fix problems outside your immediate area, proactive
3. Initiative & Persistence â€” bias for action, scrappy, get MVP done today, speed matters, no "stepping on toes"
4. Judgment & Decisiveness â€” strong instincts, right level of detail, make the call, don't delay
5. Think from First Principles â€” imagine ideal experience from scratch, not "10% better than status quo"
6. Humble â€” low ego, care about results not who's right, admit unknowns, cherish feedback
7. Customer Centricity â€” feel each customer's pain viscerally, fix things systematically, obsess over improvement
8. Uncomfortably High Standards â€” surprise and delight, quality AND speed, set industry standard
9. Unreasonably Fast â€” run not walk, "tomorrow morning" not "next week," always ask "can I be faster?"
10. Relish Discomfort â€” do what's needed especially if uncomfortable, don't avoid hard conversations
11. See for Yourself â€” dive deep, touch reality yourself, pull random tickets, audit frequently
12. Hire, Develop & Rehire the Best â€” raise the bar every hire, no monopoly on work, no toes
13. Accurately Self Aware â€” know your strengths and blind spots, acknowledge mistakes publicly, ask for feedback`;

const DEF_TALKING=`KEY TALKING POINTS â€” weave naturally into answers:

STAR STORIES:
- "Speed + quality": MacBook projector fix in 8 min before client presentation â†’ 5-star CSAT
- "Empathy under pressure": iOS update wiped photos, recovered 90% via iCloud â†’ furious to grateful
- "Above and beyond": Maria couldn't clock in at 6PM Friday, found workaround, stayed late â†’ $800 shift saved for healthcare worker
- "Pattern recognition": AirPods + macOS 13.2 bug â†’ tracked 15 cases across tickets, escalated with data â†’ Apple patched it
- "Judgment call": License email transfer not in policy â†’ verified identity, got approval, documented â†’ 5-star review
- "Mentoring": 100+ advisors trained, 30% faster ramp, 20% fewer escalations â€” structured coaching not just shadowing
- "High volume, high standards": Windows update spike tripled volume â†’ maintained 97% CSAT vs 89% team average

CLIPBOARD HEALTH VALUE ALIGNMENT:
- "Unreasonably Fast" â†’ I pride myself on being the fastest responder; I close before the customer follows up
- "Ownership" â†’ Caught issues outside my ticket: Brett's duplicate account fraud, Nadine's $74.20 payment error
- "High Standards" â†’ Zero re-opened tickets during crisis; not closing fast but closing RIGHT
- "Noticing & Curiosity" â†’ Spotted AirPods bug across 15 cases before it was flagged systemically
- "Customer Centricity" â†’ Healthcare workers can't wait â€” missed shift = someone's rent. Every ticket is urgent.
- "See for Yourself" â†’ I pull the ticket history, I read the trail, I don't just take the first description

CASE STUDY STANDOUTS (use if relevant):
- Caught Brett Murray's duplicate account fraud via AZ license match â€” another agent missed it
- Found $74.20 payment discrepancy in Nadine's ticket that would have underpaid healthcare worker Racquel
- Analyzed 55 shifts â†’ 10.9% completion rate = pattern of chronic unreliability

METRICS TO CITE: 95%+ CSAT Â· 6.5 min handle time Â· 100+ advisors trained Â· 30% ramp reduction Â· 8 years experience

STRONG CLOSING QUESTIONS TO ASK THEM:
- "What does great performance look like in the first 90 days?"
- "How does the team currently surface and escalate recurring platform issues?"
- "What's the biggest challenge the CX team is navigating right now?"
- "How does Clipboard Health think about growing the CX team internally?"

AVOID: Starting sentences with "I", generic phrases like "I'm a people person", over-explaining`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUICK QUESTIONS PER MODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const QQS={
  general:[
    "Tell me about yourself",
    "Why Clipboard Health?",
    "What are your strengths?",
    "Where do you see yourself in 3 years?",
    "What makes you the right fit?",
  ],
  behavioral:[
    "Tell me about a time you resolved a difficult customer",
    "Tell me about a time you went above and beyond",
    "Tell me about a time you caught something others missed",
    "Tell me about a time you handled high volume under pressure",
    "Tell me about a time you trained or mentored someone",
  ],
  role:[
    "How do you use Zendesk and Salesforce together?",
    "Walk me through a payment discrepancy case",
    "How do you decide when to escalate vs. solve yourself?",
    "How do you use macros without sounding robotic?",
    "How would you handle a nurse who missed a shift?",
  ],
  values:[
    "What does 'Unreasonably Fast' mean to you?",
    "Give an example of true Ownership",
    "What are Uncomfortably High Standards to you?",
    "How do you show Noticing & Curiosity in support?",
    "Tell me about a time you relished discomfort",
  ],
  closing:[
    "What are your salary expectations?",
    "When can you start?",
    "Do you have any questions for us?",
    "Why should we hire you?",
    "What motivates you in a support role?",
  ],
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CHEAT SHEET â€” From Interview Prep Guide
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CHEAT_SHEET=[
  {
    keywords:['high-pressure','balance speed','quality','pressure situation','fast and accurate','speed with quality'],
    q:'Tell me about a time you handled a high-pressure support situation. How did you balance speed with quality?',
    a:`*SITUATION* At Teleperformance supporting Mac+ customers, a client preparing for a critical business presentation in 2 hours couldn't connect their MacBook to the projector. They were panicking â€” their entire pitch depended on it.

*TASK* Diagnose the issue quickly while keeping the customer calm. A slow resolution could cost them a major business opportunity.

*ACTION* I immediately acknowledged the urgency: **"I understand how critical this is. Let's troubleshoot this together right now â€” I won't let you down."** I asked targeted questions to isolate the cause â€” HDMI vs USB-C, macOS version, display settings. Within 3 minutes I identified it: display preferences were set to mirror-only. I walked them through the fix step-by-step while documenting everything in the CRM simultaneously.

*RESULT* Issue resolved in **under 8 minutes**. The customer made their presentation on time and sent a follow-up email to my supervisor. The interaction became a **team coaching example** on balancing speed with thoroughness â€” and earned a **5-star CSAT rating**.`
  },
  {
    keywords:['empathy','frustrated','angry','maintain empathy','furious','upset customer','de-escalate'],
    q:'How do you maintain empathy when dealing with frustrated or angry customers?',
    a:`I remind myself that frustrated customers aren't upset with me â€” they're upset with the **situation**. My role is to be their advocate and problem-solver.

When I mentored advisors at Apple, I taught the **Acknowledge â†’ Empathize â†’ Act** framework: *"I completely understand why this is frustrating â€” unexpected charges would upset me too. Let me look into this right now and make sure we get this corrected for you."*

The key is active listening without defensiveness. I let customers vent **30â€“60 seconds** if needed, then shift to solution mode. One example: a customer was furious about a failed iOS update that wiped their photos. I said, **"I can hear how important those photos are. Let's explore every recovery option available."** We recovered **90% of their photos** through an iCloud backup they didn't know existed â€” they went from furious to grateful in 20 minutes.`
  },
  {
    keywords:['zendesk','workflow','ticket','support ticket','walk me through','handle a ticket'],
    q:'Walk me through your workflow for handling a typical support ticket in Zendesk.',
    a:`*Step 1 â€” Initial Triage (first 30 sec)* Read subject and description carefully. Check user profile for previous tickets, account status, and merged requests. Set priority level â€” payment issues = **high priority**.

*Step 2 â€” Investigation (2â€“3 min)* Pull account details, transaction history, and system logs. Use macros as a framework but always **personalize**. Document investigation steps in internal notes.

*Step 3 â€” Resolution & Response (3â€“5 min)* Craft a personalized response using the worker's name. Provide clear step-by-step instructions. Set correct ticket status â€” solved / pending / escalated. Add relevant **tags for trend tracking**.

*Step 4 â€” Quality Check (1 min)* Re-read response for clarity and tone. Verify all required fields are complete. Add follow-up reminders where needed.

Key practice: I always add **internal notes explaining why I made certain decisions** â€” e.g., *"Waived late fee because customer showed proof of hospital visit."* My average handle time was **6.5 minutes** with **95%+ CSAT**.`
  },
  {
    keywords:['documentation','accurate','multiple channels','document','notes','simultaneous'],
    q:'How do you ensure accurate documentation when handling multiple channels simultaneously?',
    a:`Documentation accuracy is **non-negotiable**. I document as I work, not after.

My internal note template for a payment dispute includes: **Issue Type | Root Cause | Action Taken | Follow-up Needed**. If I'm on chat and discover the issue was a failed bank verification, I immediately add a note before moving on.

Before closing any ticket, I run a **15-second review**: Did I update all required fields? Are my notes clear enough for a peer review? Did I tag for trend analysis?

At Microsoft, my detailed notes once **saved the next agent 20 minutes** of re-investigation on a follow-up ticket â€” reinforcing that good documentation is a **team multiplier**, not extra work.`
  },
  {
    keywords:['judgment call','policy','not in policy','outside guidelines','decision','escalate versus','escalate vs'],
    q:'Describe a time when you had to make a judgment call not explicitly covered in policy guidelines.',
    a:`*SITUATION* A Microsoft customer accidentally purchased a software license using their work email instead of their personal email. The license was already activated, and they were leaving their job in 3 days. Standard policy: **no transfers after activation**.

*TASK* Decide whether to strictly enforce policy or find a solution that balanced company rules with legitimate customer need.

*ACTION* I verified the customer was the original purchaser via payment method. I assessed the risk â€” this was genuine user error, not fraud. I consulted my team lead, explained the context, and we agreed to **deactivate the work-email license and issue a replacement key** to the personal email, with the original key permanently invalidated. I documented everything thoroughly.

*RESULT* Customer left a **5-star review** and mentioned me by name. I added this scenario to our internal knowledge base as *"License Email Correction â€“ Verification Required"* â€” so future agents could handle similar cases without escalating.`
  },
  {
    keywords:['escalate','when to escalate','handle yourself','escalation decision','escalate or solve'],
    q:'How do you decide when to escalate versus when to handle an issue yourself?',
    a:`I use a decision framework based on **three factors: complexity, authority, and time-sensitivity**.

**Handle myself when:** it's within my documented authority, I have the tools and knowledge to resolve it fully, and escalating would only add delay.

**Escalate when:** it requires access or permissions I don't have, it's a policy gray area needing leadership input, it could set a precedent for other users, or platform integrity is at risk.

Real example: A healthcare worker needed payment processed urgently before rent was due. The delay was on the facility side. Instead of saying *"wait 3â€“5 days,"* I checked for blocks, confirmed it was a facility verification delay, and contacted our facility relations team via Slack to expedite. **Payment processed same-day.** I didn't escalate because I had the authority â€” but I also knew my limits. The key question: **"Am I the best person to solve this right now, or will escalation lead to a better outcome?"**`
  },
  {
    keywords:['macro','template','personalize','templated response','personalization','balance efficiency'],
    q:'How do you balance efficiency with personalization when using templated responses?',
    a:`Macros are my **starting point, not my endpoint**. I think of them like a recipe â€” follow the base structure, but add the right seasoning for each customer.

Instead of *"Hi there, I understand you're having an issueâ€¦"* I say **"Hi Marcus, I understand you're concerned about your Friday shift paymentâ€¦"**

Instead of *"We've reviewed your case and foundâ€¦"* I say **"I've reviewed your December 15th shift at Memorial Hospital and foundâ€¦"**

At Apple, I personalized our generic password reset macro by acknowledging the customer's specific situation and proactively teaching them about two-factor authentication. My CSAT for **macro-appropriate issues was actually higher** than for complex troubleshooting â€” because customers felt heard even on simple issues.`
  },
  {
    keywords:['outdated macro','incorrect macro','wrong information','broken macro','macro error','macro contained'],
    q:'What would you do if you noticed a macro contained outdated or incorrect information?',
    a:`Two steps: **Immediate Fix + Systematic Correction.**

**Immediate:** Don't use the broken macro. Write the correct response manually and add an internal note: *"Did not use [Macro Name] â€” contains outdated info."*

**Systematic:** Report to supervisor/knowledge team with specifics. Check if related macros have the same issue. Offer to draft the corrected version.

At Microsoft, I caught a macro referencing a deprecated tool. I immediately apologized to the customer, sent the correct resource, reported the issue, and within **48 hours the macro was updated** with a team-wide notification.

The key: **don't just work around errors â€” fix them so the next person benefits.** That's ownership.`
  },
  {
    keywords:['pattern','recurring','trend','identified a pattern','flagged','repeat issue','systemic'],
    q:'Give me an example of when you identified a pattern in customer issues and took action.',
    a:`*SITUATION* At Teleperformance, I received **4â€“5 AirPods connectivity tickets per day** over 2 weeks â€” unusually high. Normally 1â€“2 per week. All were Mac+ users.

*TASK* Determine if this was systemic or coincidence, and if systemic, escalate with actionable data.

*ACTION* I tracked every ticket in a simple log: date, macOS version, AirPods model, error description. After **15 cases**, I found **90% had updated to macOS 13.2**. I tested it myself â€” confirmed a Bluetooth regression bug. I compiled a concise report with volume spike data, 90% correlation, a temporary workaround, and a fix timeline recommendation. I also drafted a knowledge base article.

*RESULT* Leadership escalated to Apple, who confirmed the bug and released a **patch in 10 days**. My workaround helped ~**50 customers** in the interim. Team productivity improved â€” agents stopped spending 20 minutes troubleshooting. I received a **spot bonus** for proactive problem identification.`
  },
  {
    keywords:['trend monitoring','balance responding','analyze trends','trend analysis','workflow trend'],
    q:'How do you balance responding to tickets versus taking time to analyze trends?',
    a:`Trend monitoring is **embedded in my daily workflow**, not separate from it.

**Real-time:** If I see the same issue twice â†’ mental note. Three times â†’ start tracking. Zero extra time.

**End of shift:** Quick scan of closed tickets. Log any patterns in a running note. **5 minutes/day.**

**Weekly:** Review trend notes. Escalate with data if pattern is confirmed â€” volume, common factor, root cause hypothesis, recommendation. **15 minutes/week.**

ROI example: At Microsoft, 10 minutes of weekly review revealed printer driver issues spiked after **every Windows update**. I flagged the pattern with data â€” Microsoft released a hotfix, and **printer tickets dropped 40%** the following month. That's the ROI: 10 minutes of analysis prevented hundreds of future tickets.`
  },
  {
    keywords:['training','mentoring','onboarding','mentor','new team members','train','coach','new advisors'],
    q:'Tell me about your experience training or mentoring new team members. What\'s your approach?',
    a:`My approach is **"Build Confidence Through Competence."**

*Week 1 â€” Foundation:* Shadowing. New advisors shadow me for 3â€“5 tickets. I narrate my thinking out loud: *"I'm checking their account history first becauseâ€¦"* We debrief after each ticket.

*Week 2 â€” Guided Practice:* They handle tickets while I observe in real-time, on backup chat. Immediate feedback: **2 things done well, 1 to improve**.

*Week 3 â€” Coached Independence:* They work independently; I review every ticket within 24 hours. Daily 15-minute huddle: *"What was your toughest ticket today?"*

*Week 4+ â€” Ongoing Support:* Flying solo, but I check in proactively. I celebrate wins publicly.

**Secret Weapon â€” Pattern Recognition:** Instead of teaching *"how to fix X,"* I teach *"how to diagnose X."* For example: *"When a worker says they didn't get paid, 90% of the time it's one of three things: bank verification, timesheet not submitted, or facility approval delay. Here's how to check each in 60 seconds."*

Result at Apple: **100+ advisors trained**, **30% faster ramp time**, **20% fewer escalations**.`
  },
  {
    keywords:['above and beyond','not required','extra mile','went above','ownership','maria','clock in','shift'],
    q:'Tell me about a time when you went above and beyond for a customer, even when it wasn\'t required.',
    a:`*SITUATION* A healthcare worker named Maria contacted support on a **Friday evening** â€” she couldn't clock in to her shift due to an app error. Missing the shift meant losing **$800+** and potentially hurting her account standing.

*TASK* Standard protocol: submit a ticket, tell her engineering will investigate in 1â€“2 business days. But she needed the shift that night.

*ACTION* I told Maria, **"I'm not going to let you lose this shift. Let me try everything I can right now."** After 15 minutes of troubleshooting without success, I escalated to our tech team via Slack (after hours), and simultaneously found a workaround in the knowledge base â€” the **mobile browser version**. I walked Maria through it and she clocked in successfully.

*RESULT* Maria worked her shift and got paid. She sent a **thank-you email** to my supervisor. My bug report led to an **app patch 2 weeks later**. Three other agents used my workaround documentation to help similar cases â€” turning one worker's crisis into a **systemic improvement**.`
  },
  {
    keywords:['high standards','under pressure','tight deadline','maintained standards','quality under pressure','windows update','volume spike'],
    q:'Describe a situation where you maintained high standards even under pressure or tight deadlines.',
    a:`During a major Windows update rollout at Microsoft, ticket volume **spiked 3x overnight**. Some team members took shortcuts â€” copy-pasting generic responses, closing tickets without confirmation, skipping documentation. **I refused to compromise quality.**

I maintained full documentation on every ticket, verified all resolutions before marking them solved, and owned my mistakes proactively â€” when I sent Windows 10 steps to a Windows 11 user, I caught and corrected it immediately.

The results spoke for themselves:

**My handle time** was 20% slower than shortcuts â€” but my **CSAT was 97%** vs the team's 89%. My **re-opened ticket rate was 0%** vs the team's 12%.

The lesson: being unreasonably fast and having uncomfortably high standards aren't opposites. **Speed without accuracy creates more tickets. Quality is actually faster in the long run.**`
  },
  {
    keywords:['why clipboard','why this company','why e-connect','why do you want','why us','mission','values match'],
    q:'Why do you want to work for Clipboard Health specifically?',
    a:`Clipboard Health's marketplace **directly impacts healthcare workers' ability to get paid** and facilities' ability to stay staffed. Having spent **8+ years** solving urgent problems for Microsoft and Apple customers, I want to work where that urgency has **real stakes** â€” patient care, worker income, marketplace reliability.

The values alignment is exact. **Ownership** â€” I dug into a case and caught duplicate account fraud another agent missed. **Uncomfortably High Standards** â€” I found a **$74 payment discrepancy** that would have underpaid a healthcare worker. **Unreasonably Fast** â€” **6.5 minute handle time, 95%+ CSAT**.

I'm not just looking for a job â€” I want to **be a multiplier**, not just a ticket-closer. Whether mentoring new hires, improving processes, or identifying trends that make the platform better, I want to contribute to something I genuinely believe in.`
  },
  {
    keywords:['weakness','biggest weakness','area of improvement','struggle','improve','perfectionism'],
    q:'What\'s your biggest weakness?',
    a:`I sometimes struggle with **perfectionism** â€” early in my career I'd spend 10 minutes crafting the perfect response to a simple password reset. My supervisor flagged it: *"Save that energy for complex problems."*

I developed a **complexity triage method**: low-complexity tickets get polished macros in 3â€“5 minutes; high-complexity issues get full scrutiny. My handle time improved by **40%** while maintaining CSAT.

I still bring high standards â€” but I've learned that **"high standards" means appropriate to context**, not always perfect. When I see Clipboard Health's values â€” *unreasonably fast* and *uncomfortably high standards* â€” that balance is exactly what I've had to consciously develop.`
  },
  {
    keywords:['3 years','2 years','career goals','see yourself','future','growth','plan'],
    q:'Where do you see yourself in 2â€“3 years?',
    a:`**Year 1 â€” Master the role:** Become an expert in Clipboard Health's policies and tools, achieve top-tier metrics, and start contributing to the knowledge base.

**Year 2 â€” Expand impact:** Take on formal mentorship, lead process optimization initiatives, become the go-to for complex escalations.

**Year 3 â€” Strategic contribution:** Drive major improvements in CX metrics, bridge frontline support and product/operations teams, and pursue a **senior or lead role** if available.

The common thread: I want to be the person who makes the whole team better â€” not just the person who closes the most tickets.`
  },
  {
    keywords:['clock in','30 minutes','cant clock in','shift issue','worker cant','technical issue shift','healthcare worker'],
    q:'A healthcare worker contacts you 30 minutes before their shift. They can\'t clock in. Walk me through how you\'d handle this.',
    a:`*Step 1 â€” Acknowledge & Commit (15 sec):* **"Hi [Name], I understand you need to clock in in 30 minutes. I'm going to help you resolve this right now â€” let's figure this out together."**

*Step 2 â€” Quick Diagnostic:* What happens when you try? Any error message? App or web browser? First time at this facility?

*Step 3 â€” Root Cause Check:* Account status (active? any holds?). Shift details (still assigned? correct date?). Technical (app version, connectivity). Facility (verification pending?).

*Step 4 â€” Resolve or Workaround:* App glitch â†’ clear cache or browser version. Account issue â†’ fix within authority. Facility pending â†’ Slack urgent channel. Technical â†’ alternate clock-in method.

*Step 5 â€” Escalate if Needed:* If unresolved within 10 min and shift starts in 20 min â†’ escalate with **full context**. Stay on the line. Explore manual workarounds (facility supervisor verification).

*Step 6 â€” Confirm & Follow Up:* **"Can you try clocking in now to confirm?"** Add account note. Follow up after shift to confirm payment processed correctly.`
  },
  {
    keywords:['disagree with policy','enforce policy','policy you disagree','policy conflict','had to enforce'],
    q:'How would you handle a situation where you disagreed with a policy but had to enforce it?',
    a:`**In the moment: Enforce with empathy.**

Never undermine the company. Say: *"I understand this is frustrating. Here's why the policy existsâ€¦ While I need to follow this policy, let me see if there's any flexibility or alternative I can explore."*

**After the interaction: Advocate through data.**

If I see the same policy causing repeated harm, I collect data â€” how many cases, what outcome, what workers experience â€” and present a **solution, not just a complaint**.

At Microsoft, I advocated for extending the refund window from 14 to 30 days for documented extenuating circumstances. I presented **15 cases with data**. The policy changed.

Policies exist for good reasons â€” but if they repeatedly conflict with the mission, they deserve **review through proper channels**.`
  },
  {
    keywords:['unreasonably fast','fast value','speed value','what does fast mean','run not walk'],
    q:'What does "Unreasonably Fast" mean to you?',
    a:`To me, **Unreasonably Fast** means solving problems before the customer even thinks to follow up.

It's not about rushing and making mistakes â€” it's about removing all unnecessary friction from your process so that **speed is your default**, not your exception.

In practice: When I'm on a support ticket, I'm already logging notes while I'm still reading the issue. I'm already anticipating the next step before the customer replies. My **6.5 minute average handle time** with **95%+ CSAT** isn't luck â€” it's a deliberate system.

The Clipboard Health framing resonates with me: *"When someone asks if they can get back to you next week, you reply 'how about tomorrow morning.'"* That's exactly how I operate â€” because healthcare workers **can't afford to wait**.`
  },
  {
    keywords:['ownership','own it','accountability','own the problem','full responsibility','take ownership'],
    q:'Give me an example of true Ownership.',
    a:`Ownership means **you don't put the problem down until it's solved** â€” even if it's technically outside your ticket.

Best example: I was reviewing a case flagged by another agent and noticed something they'd missed â€” the customer had **two active accounts with matching Arizona license information**. The original agent closed the ticket as resolved. I reopened it, cross-referenced the account history, and confirmed it was **duplicate account fraud**.

I didn't pass it back. I documented the full finding, escalated with a detailed fraud report, and added the detection pattern to our internal knowledge base so other agents could catch it early.

That's ownership â€” **fixing the problem you see, not just the problem you were assigned**.`
  },
  {
    keywords:['high standards','uncomfortably high','what are high standards','quality','standards mean'],
    q:'What are Uncomfortably High Standards to you?',
    a:`Uncomfortably High Standards means **not accepting "good enough" when excellent is achievable** â€” even when no one is watching.

During a Microsoft update crisis with **3x ticket volume**, when other agents were copy-pasting generic responses and skipping documentation, I maintained full notes on every ticket, verified every resolution, and corrected my own mistakes proactively.

Result: **97% CSAT vs. 89% team average. Zero re-opened tickets vs. 12% team rate.**

The "uncomfortable" part is real â€” it means catching a **$74 payment discrepancy** in a ticket when you could have easily closed it. It means spending an extra 2 minutes documenting a judgment call that no one might ever read. It means **holding yourself to a standard higher than what's measured**.`
  },
  {
    keywords:['questions for us','questions for interviewer','ask you','ask them','your questions'],
    q:'Do you have any questions for us?',
    a:`Yes â€” I have a few I'd genuinely love to understand better:

**"What does great performance look like in the first 30, 60, and 90 days in this role?"**

**"What are the most common escalations or challenging scenarios your support team faces right now?"**

**"What's the feedback loop between frontline support and product/operations? How are support insights used to improve the platform?"**

**"How does the team maintain 'uncomfortably high standards' while being 'unreasonably fast'? What does that balance look like day-to-day?"**

And honestly â€” **"What excites you most about Clipboard Health's direction over the next 1â€“2 years?"**`
  },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FUZZY CHEAT SHEET MATCHING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let flashTimer=null, flashKept=false;
const FLASH_DURATION=10000; // 10 seconds

function findCheatMatch(text){
  const t=text.toLowerCase();
  let bestMatch=null, bestScore=0;
  for(const entry of CHEAT_SHEET){
    let score=0;
    for(const kw of entry.keywords){
      if(t.includes(kw.toLowerCase())) score+=kw.split(' ').length; // longer keyword = higher weight
    }
    if(score>bestScore){ bestScore=score; bestMatch=entry; }
  }
  return bestScore>=2?bestMatch:null; // require at least score 2 to show
}

function showFlash(match, question){
  flashKept=false;
  clearTimeout(flashTimer);

  document.getElementById('flash-q-text').textContent=`"${question}"`;
  document.getElementById('flash-match-label').textContent=`Matched: ${match.q.substring(0,40)}â€¦`;
  document.getElementById('flash-body').innerHTML=fmtFlash(match.a);

  const overlay=document.getElementById('flash-overlay');
  overlay.classList.add('show');

  // Start timer ring animation
  const ftf=document.getElementById('ftf');
  ftf.style.transition='none';
  ftf.style.strokeDashoffset='0';
  ftf.getBoundingClientRect();
  ftf.style.transition=`stroke-dashoffset ${FLASH_DURATION}ms linear`;
  ftf.style.strokeDashoffset='57';

  // Auto-hide after duration
  flashTimer=setTimeout(()=>{ if(!flashKept) dismissFlash(); }, FLASH_DURATION);
}

function dismissFlash(){
  clearTimeout(flashTimer);
  const o=document.getElementById('flash-overlay');
  o.style.animation='flashOut .3s ease forwards';
  setTimeout(()=>{ o.classList.remove('show'); o.style.animation=''; },300);
}

function keepFlash(){
  flashKept=true;
  clearTimeout(flashTimer);
  // Stop ring animation
  const ftf=document.getElementById('ftf');
  ftf.style.transition='none';
  document.getElementById('flash-match-label').textContent='ğŸ“Œ Pinned â€” tap Dismiss to hide';
  showToast('ğŸ“Œ Pinned â€” will stay until dismissed');
}

function copyFlash(){
  const text=document.getElementById('flash-body').innerText;
  navigator.clipboard.writeText(text).then(()=>showToast('âœ“ Copied'));
}

function fmtFlash(text){
  return text
    .replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>')
    .replace(/\*(SITUATION|TASK|ACTION|RESULT|Step \d[^*]*)\*/gi,'<em>$1</em>')
    .replace(/\*(.*?)\*/g,'<span style="color:var(--text2)">$1</span>')
    .replace(/\n\n+/g,'</p><p>')
    .replace(/\n/g,'<br/>')
    .replace(/^/,'<p>').replace(/$/,'</p>');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let apiKey='', sessionActive=false, recognition=null;
let isThinking=false, silenceTimer=null;
let finalTx='', interimTx='', heardEl=null;
let currentMode='general';
const SILENCE=2500;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BOOT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('DOMContentLoaded',()=>{
  const k=ls('iai_key'); if(k) document.getElementById('api-key-input').value=k;
  renderQQs();
});

function ls(k,v){
  try{ if(v===undefined)return localStorage.getItem(k); localStorage.setItem(k,v); }
  catch(e){return null;}
}

function startApp(){
  const key=document.getElementById('api-key-input').value.trim();
  if(!key||key.length<20){showToast('âš  Enter Gemini API key (starts with AIzaSyâ€¦)');return;}
  apiKey=key; ls('iai_key',key);
  if(!ls('iai_resume')) ls('iai_resume',DEF_RESUME);
  if(!ls('iai_job'))    ls('iai_job',DEF_JOB);
  if(!ls('iai_talking'))ls('iai_talking',DEF_TALKING);
  if(!ls('iai_name'))   ls('iai_name','Adrian Alasco');
  if(!ls('iai_length')) ls('iai_length','standard');
  document.getElementById('setup').style.display='none';
  document.getElementById('app').style.display='flex';
  initSpeech();
  setStatus('idle','Ready â€” tap START');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SPEECH â€” robust with abort/restart handling
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let restartTimer=null, restartAttempts=0, isRestarting=false;
const MAX_RESTARTS=99; // keep retrying indefinitely during a live session

function buildRecognition(){
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!SR) return null;
  const r=new SR();
  r.continuous=true;
  r.interimResults=true;
  r.lang='en-US';
  r.maxAlternatives=1;

  r.onstart=()=>{
    isRestarting=false; restartAttempts=0;
    setStatus('live','â— Listeningâ€¦');
    ringState('listen');
    document.getElementById('wbars').classList.add('show');
    document.getElementById('mic-icon').style.display='none';
  };

  r.onresult=(e)=>{
    finalTx=''; interimTx='';
    for(let i=e.resultIndex;i<e.results.length;i++){
      if(e.results[i].isFinal) finalTx+=e.results[i][0].transcript;
      else interimTx+=e.results[i][0].transcript;
    }
    updateHeard(finalTx||interimTx,!finalTx);
    if(finalTx){ clearTimeout(silenceTimer); startCountdown(); }
  };

  r.onerror=(e)=>{
    // 'aborted' fires when we stop intentionally OR browser cuts it â€” always safe to ignore
    if(e.error==='aborted'||e.error==='no-speech') return;
    // Network / not-allowed errors â€” show message
    if(e.error==='not-allowed'||e.error==='service-not-allowed'){
      ringState('err');
      setStatus('err','âš  Mic blocked â€” check browser permissions');
      showToast('âš  Mic permission denied â€” click the ğŸ”’ icon in address bar');
      sessionActive=false; updateMicUI(false);
      return;
    }
    // Other errors (network, audio-capture) â€” silently retry
    setStatus('live','â— Reconnectingâ€¦');
  };

  r.onend=()=>{
    if(!sessionActive) return;
    // Always restart if session is still active, with small cooldown to avoid tight loops
    if(restartAttempts>=MAX_RESTARTS){ stopSession(); return; }
    const delay=isRestarting?400:100; // slightly longer delay on repeated restarts
    isRestarting=true; restartAttempts++;
    clearTimeout(restartTimer);
    restartTimer=setTimeout(()=>{
      if(!sessionActive) return;
      try{ recognition.start(); }
      catch(ex){
        // If recognition object is broken, rebuild it
        recognition=buildRecognition();
        setTimeout(()=>{ try{recognition.start();}catch(e){} },300);
      }
    },delay);
  };

  return r;
}

function initSpeech(){
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!SR){showToast('âš  Voice not supported â€” use Chrome or Edge');return;}
  recognition=buildRecognition();
}

function toggleSession(){
  if(!recognition){showToast('Voice requires Chrome or Edge');return;}
  sessionActive?stopSession():startSession();
}

function startSession(){
  sessionActive=true; finalTx=''; interimTx='';
  restartAttempts=0; isRestarting=false;
  updateMicUI(true);
  hideEmpty();
  try{recognition.start();}catch(e){
    // If already started, stop first then restart
    try{recognition.stop();}catch(ex){}
    setTimeout(()=>{ try{recognition.start();}catch(ex){} },300);
  }
}

function stopSession(){
  sessionActive=false;
  clearTimeout(silenceTimer); clearTimeout(restartTimer);
  updateMicUI(false);
  resetSfill();
  ringState('idle'); setStatus('idle','Session ended');
  heardEl=null;
  try{recognition.stop();}catch(e){}
}

function updateMicUI(live){
  const btn=document.getElementById('mic-btn');
  if(live){
    btn.classList.add('live');
    document.getElementById('mic-lbl').textContent='LIVE â€” TAP TO STOP';
    document.getElementById('sbar').classList.add('show');
  } else {
    btn.classList.remove('live');
    document.getElementById('mic-lbl').textContent='START';
    document.getElementById('mic-icon').style.display='';
    document.getElementById('wbars').classList.remove('show');
    document.getElementById('sbar').classList.remove('show');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SILENCE COUNTDOWN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startCountdown(){
  resetSfill();
  const sf=document.getElementById('sfill');
  sf.getBoundingClientRect(); // force reflow
  sf.style.transition=`width ${SILENCE}ms linear`;
  sf.style.width='100%';
  silenceTimer=setTimeout(()=>{
    const text=finalTx.trim();
    resetSfill();
    if(text.length>4) processText(text);
  },SILENCE);
}

function resetSfill(){
  const sf=document.getElementById('sfill');
  sf.style.transition='none'; sf.style.width='0%';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SMART QUESTION DETECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function isMyQuestion(text){
  const t=text.toLowerCase().trim();
  // Definitely recruiter questions â€” answer these
  const recruiter=[
    /tell me about (yourself|a time|your|how)/,
    /describe (yourself|a situation|your|how)/,
    /why (do you|are you|should we|clipboard|this role)/,
    /what (is your|are your|makes you|do you bring|would you do|motivated)/,
    /how (do you|would you|have you|did you|do you handle)/,
    /walk me through/,/give me an example/,/can you (tell|walk|describe|explain|share)/,
    /what('s| is) your (greatest|biggest|strength|weakness|approach)/,
  ];
  if(recruiter.some(p=>p.test(t))) return false;
  // Looks like Adrian asking the recruiter something (short + starts with question word)
  const mine=[
    /^(what|how|when|where|who|which)\b.{0,80}(your|the team|clipboard|the role|you all)\b/,
    /^(could you|can you tell me|is there|are there|do you offer)\b/,
    /^(just to clarify|i was wondering|quick question|one more thing)\b/,
  ];
  if(mine.some(p=>p.test(t))&&t.length<130) return true;
  return false;
}

function processText(text){
  finalTx=''; heardEl=null;
  if(isMyQuestion(text)){
    const b=document.getElementById('pause-badge');
    b.classList.add('show');
    setTimeout(()=>b.classList.remove('show'),2200);
    return;
  }
  // Check cheat sheet first
  const match=findCheatMatch(text);
  if(match) showFlash(match, text);
  // Always also generate Gemini answer below
  askGemini(text);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MANUAL INPUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function sendManual(){
  const inp=document.getElementById('minp');
  const text=inp.value.trim(); if(!text)return;
  inp.value=''; hideEmpty();
  updateHeard(text,false);
  // Check cheat sheet first
  const match=findCheatMatch(text);
  if(match) showFlash(match, text);
  askGemini(text);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GEMINI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function askGemini(question){
  if(isThinking)return;
  if(!apiKey){showToast('API key missing â€” open Settings');return;}
  isThinking=true;
  ringState('think'); setStatus('think','â—† Generatingâ€¦');
  hideEmpty();

  const resume  = ls('iai_resume')||DEF_RESUME;
  const job     = ls('iai_job')||DEF_JOB;
  const talking = ls('iai_talking')||DEF_TALKING;
  const name    = ls('iai_name')||'Adrian Alasco';
  const length  = ls('iai_length')||'standard';

  const lenGuide={
    concise:'2â€“3 sentences max. Be sharp and punchy.',
    standard:'4â€“7 sentences. Natural spoken length.',
    detailed:'Full STAR story. Thorough but still conversational.',
  }[length]||'4â€“7 sentences.';

  const modeCtx={
    general:'General interview question. Be warm and genuine.',
    behavioral:`Behavioral (Tell me about a time...). Use a concrete STAR story from the resume.
Format: start each part with a label on its own line like *SITUATION* *ACTION* *RESULT* â€” this helps Adrian scan while talking.`,
    role:'Role-specific / tool question. Be specific about Zendesk, Salesforce, macros, workflows, and exact methods.',
    values:`Clipboard Health values question. Connect answer directly to their specific values.
Core ones: Unreasonably Fast (run not walk), Ownership (own it fully), Uncomfortably High Standards (quality+speed), Noticing & Curiosity (ask why many times), Customer Centricity (feel each customer's pain viscerally).`,
    closing:'Closing / strategic question. Be confident. If they ask what questions Adrian has, provide 2â€“3 strong thoughtful ones.',
  }[currentMode]||'';

  const sys=`You are a real-time interview AI helping ${name} answer questions LIVE during a Clipboard Health job interview.

YOUR ONE JOB: Write the exact words ${name} should say out loud right now.

RULES â€” follow every one:
- Write ONLY the spoken answer. NO preamble ("Here's a good answer", "You could say", etc.)
- First person: "I didâ€¦", "What I foundâ€¦", "My experienceâ€¦"
- Tone: NATURAL and conversational â€” like speaking off the cuff, NOT reading an essay. Warm, genuine, confident.
- ${lenGuide}
- ${modeCtx}
- Only use experiences from the provided resume. NEVER invent.
- Use **bold** around key phrases (metrics, tools, outcomes, company names) â€” makes it easy for Adrian's eyes to scan while talking.
- For STAR answers: put *SITUATION* *ACTION* *RESULT* labels on their own lines as visual anchors.
- Write in flowing paragraphs â€” no bullet points.
- End with one strong, natural closing sentence.

RESUME:
${resume}

JOB & COMPANY:
${job}

TALKING POINTS & EXAMPLES:
${talking}`;

  const tid='t'+Date.now();
  addThink(tid);

  try{
    const url=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`;
    const res=await fetch(url,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        system_instruction:{parts:[{text:sys}]},
        contents:[{role:'user',parts:[{text:`Interview question: "${question}"`}]}],
        generationConfig:{maxOutputTokens:750,temperature:0.75},
      }),
    });
    removeEl(tid);
    if(!res.ok){
      const err=await res.json().catch(()=>({}));
      throw new Error(err.error?.message||`HTTP ${res.status}`);
    }
    const data=await res.json();
    const raw=data.candidates?.[0]?.content?.parts?.[0]?.text||'No response.';
    addAnswer(question,raw);
    ringState('listen'); setStatus('live','â— Listeningâ€¦');
  }catch(e){
    removeEl(tid);
    ringState('err'); setStatus('err','âš  Error â€” check API key');
    showToast('Error: '+(e.message||'Check API key'));
    document.getElementById('feed').insertAdjacentHTML('beforeend',
      `<div class="ercard">âš  ${e.message||'Something went wrong.'}</div>`);
    scrollFeed();
  }
  isThinking=false;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateHeard(text,interim){
  if(!heardEl){
    heardEl=document.createElement('div');
    heardEl.className='heard';
    heardEl.innerHTML='<div class="heard-lbl">ğŸ™ HEARD</div><div class="heard-txt" id="heard-txt"></div>';
    document.getElementById('feed').appendChild(heardEl);
    hideEmpty();
  }
  const el=document.getElementById('heard-txt');
  if(el){ el.textContent=text||(interim?'Listeningâ€¦':''); el.className='heard-txt'+(interim?' interim':''); }
  scrollFeed();
}

function addThink(id){
  const el=document.createElement('div');
  el.className='think-card'; el.id=id;
  el.innerHTML='<div class="tdots"><span></span><span></span><span></span></div><div class="think-txt">Generating your answerâ€¦</div>';
  document.getElementById('feed').appendChild(el);
  scrollFeed();
}

function addAnswer(question,raw){
  heardEl=null;
  const id='a'+Date.now();
  const now=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
  const card=document.createElement('div');
  card.className='acard';
  card.innerHTML=`
    <div class="ahead">
      <div class="ahead-l">
        <div class="albl">ANSWER</div>
        <div class="mbadge">${currentMode.toUpperCase()}</div>
      </div>
      <div class="atime">${now}</div>
    </div>
    <div class="abody" id="${id}">${fmt(raw)}</div>
    <div class="afoot">
      <button class="afbtn" onclick="copyA('${id}')">â˜ Copy</button>
      <button class="afbtn" onclick="regen('${question.replace(/'/g,"\\'")}')">â†º Retry</button>
      <button class="afbtn" onclick="this.closest('.acard').remove()">âœ•</button>
    </div>`;
  document.getElementById('feed').appendChild(card);
  scrollFeed();
}

function fmt(text){
  return text
    .replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>')
    .replace(/\*(SITUATION|TASK|ACTION|RESULT|S:|T:|A:|R:)\*?:?/gi,'<em>$1</em>')
    .replace(/\*(.*?)\*/g,'<span style="color:var(--text2)">$1</span>')
    .replace(/\n\n+/g,'</p><p>')
    .replace(/\n/g,'<br/>')
    .replace(/^/,'<p>')
    .replace(/$/,'</p>');
}

function copyA(id){
  navigator.clipboard.writeText(document.getElementById(id)?.innerText||'')
    .then(()=>showToast('âœ“ Copied'));
}

function regen(q){
  hideEmpty();
  updateHeard(q,false);
  askGemini(q);
}

function removeEl(id){ document.getElementById(id)?.remove(); }

function hideEmpty(){
  const e=document.getElementById('empty'); if(e) e.style.display='none';
}

function clearFeed(){
  document.getElementById('feed').innerHTML=
    `<div class="empty" id="empty">
      <div class="empty-ring">ğŸ™</div>
      <div class="empty-h">Feed cleared</div>
      <div class="empty-d">Tap START and keep going.</div>
    </div>`;
  heardEl=null;
  showToast('Feed cleared');
}

function scrollFeed(){
  const f=document.getElementById('feed');
  setTimeout(()=>f.scrollTop=f.scrollHeight,50);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUICK QS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderQQs(){
  const row=document.getElementById('qqs'); row.innerHTML='';
  (QQS[currentMode]||[]).forEach(q=>{
    const c=document.createElement('button');
    c.className='qchip'; c.textContent=q;
    c.onclick=()=>{
      c.classList.add('hi'); setTimeout(()=>c.classList.remove('hi'),600);
      hideEmpty(); updateHeard(q,false); askGemini(q);
    };
    row.appendChild(c);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setMode(m){
  currentMode=m;
  document.querySelectorAll('.mtab').forEach(t=>t.classList.remove('on'));
  document.getElementById('tab-'+m).classList.add('on');
  renderQQs();
  showToast('Mode: '+m.charAt(0).toUpperCase()+m.slice(1));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RING / STATUS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function ringState(s){
  const r=document.getElementById('rf'), ic=document.getElementById('ring-icon');
  r.className='rf';
  if(s==='listen'){r.classList.add('listen');ic.textContent='ğŸ™';}
  else if(s==='think'){r.classList.add('think');ic.textContent='â—†';}
  else if(s==='err'){r.classList.add('err');ic.textContent='âš ';}
  else{ic.textContent='ğŸ™';}
}

function setStatus(s,txt){
  const el=document.getElementById('t-status');
  el.textContent=txt; el.className='t-status';
  if(s==='live') el.classList.add('live');
  else if(s==='think') el.classList.add('think');
  else if(s==='err') el.classList.add('err');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openSettings(){
  document.getElementById('s-key').value=apiKey||ls('iai_key')||'';
  document.getElementById('s-name').value=ls('iai_name')||'Adrian Alasco';
  document.getElementById('s-resume').value=ls('iai_resume')||DEF_RESUME;
  document.getElementById('s-job').value=ls('iai_job')||DEF_JOB;
  document.getElementById('s-talking').value=ls('iai_talking')||DEF_TALKING;
  document.getElementById('s-length').value=ls('iai_length')||'standard';
  document.getElementById('settings').classList.add('open');
}
function closeSettings(){ document.getElementById('settings').classList.remove('open'); }
function saveSettings(){
  const k=document.getElementById('s-key').value.trim();
  if(k){apiKey=k;ls('iai_key',k);}
  ls('iai_name',document.getElementById('s-name').value);
  ls('iai_resume',document.getElementById('s-resume').value);
  ls('iai_job',document.getElementById('s-job').value);
  ls('iai_talking',document.getElementById('s-talking').value);
  ls('iai_length',document.getElementById('s-length').value);
  closeSettings(); showToast('âœ“ Settings saved');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let tt;
function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  clearTimeout(tt); tt=setTimeout(()=>t.classList.remove('show'),2800);
}
</script>
</body>
</html>
